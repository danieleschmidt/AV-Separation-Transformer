
groups:
- name: av-separation-alerts
  rules:
  - alert: HighRequestLatency
    expr: histogram_quantile(0.95, rate(av_separation_request_duration_seconds_bucket[5m])) > 2
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "High request latency detected"
      description: "95th percentile latency is {{ $value }}s"
      
  - alert: HighErrorRate
    expr: rate(av_separation_requests_total{status=~"5.."}[5m]) > 0.1
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "High error rate detected"
      description: "Error rate is {{ $value }} errors/sec"
      
  - alert: PodCrashLooping
    expr: rate(kube_pod_container_status_restarts_total[15m]) > 0
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "Pod is crash looping"
      description: "Pod {{ $labels.pod }} in {{ $labels.namespace }} is restarting frequently"
      
  - alert: GPUNotAvailable
    expr: av_separation_gpu_available == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "GPU not available"
      description: "No GPU detected on instance {{ $labels.instance }}"
